this is a slightly modified portable version used by FCUDA. 
FCUDA-SoC: Platform Integration for Field-Programmable SoC with the CUDA-to-FPGA Compiler
